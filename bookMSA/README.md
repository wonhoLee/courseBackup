# 마이크로 서비스 패턴
---
## 2장 분해전략
### 2.1
### 2.2 마이크로서비스 아키텍처 정의
- 아키텍쳐 정의
  - 1단계 : 애플리케이션 요건을 핵심 요청으로 추출
  - 2단계 : 어떻게 여러 서비스로 분해할지 결정 하는 것
  - 3단계 : 서비스별로 API를 정의 하는 일
- 분해과정 장애물
  - 네트워크 지연(network latency)
  - 서비스 간 동기 통신으로 인해 가용성이 떨어지는 문제
    - 해결책 : 자기 완비형 서비스(self-contained service)(3장)
  - 데이터 일관성 지키기
    - 해결책 : 사가(4장)
  - 만능 클래스
    - 해결책 : DDD 개념
#### 2.2.1 시스템 작업 식별
- 시스템 작업 정의
- 사용자 스토리와 사용자 시나리오등의 애플리케이션 요건
- 1단계 : 고수준의 도메인 모델을 생성
- 2단계 : 도메인 모델 관점에서 기술
#### 2.2.2 서비스 정의: 비즈니스 능력 패턴별 분해
- 1 : 비즈니스 능력에 따라 분해하는 것
- 비즈니스 능력은 곧 조직이 하는 일이다
- 비즈니스 능력 식별
- 비즈니스 능력을 여러 서비스로
#### 2.2.3 서비스 정의: 하위 도메인 패턴별 분해
- DDD
  - 하위 도메인(sub-domain)
  - 경계 컨텍스트(bounded context)
#### 2.2.4 분해 지침
- 단일 책임 원칙(SRP, Single Responsibility Principle)
- 공동 폐쇄 원칙(CCP, Common Closure Principle)
#### 2.2.5 서비스 분해의 장애물
- 네트워크 지연
  - 해결책
    - 한 차례 왕복으로 여러 객체를 한 번에 가져오는 배치 API
    - 값비싼 IPC를 언어 수준의 메서드나 함수 호출로 대체하는 식
- 동기 IPC로 인한 가용성 저하
  - 비동기 메시징(3장)
- 여러 서비스에 걸쳐 데이터 일관성 유지
- 일관된 데이터 뷰 확보
- 만능 클래스는 분해의 걸림돌
#### 2.2.6 서비스 API 정의
- 시스템 작업을 서비스로 배정
- 서비스 간 협동 지원에 필요한 API 확정
---
## 3장 프로세스 간 통신
### 3.1 마이크로서비스 아키텍처 IPC 개요
#### 3.1.1 상호 작용 스타일
- 일대일 / 일대다 여부
- 동기 / 비동기 여부
- 일대일
  - 요청/응답(request / response)
  - 비동기 요청/응답(asynchronous request / response)
  - 단방향 알림(one-way notification)
- 일대다
  - 발행/구독(publish/subscribe)
  - 발행/비동기 응답(publish/async response)
#### 3.1.2 마이크로서비스 API 정의
#### 3.1.3 API 발전시키기
- 시맨틱 버저닝(Semvers, Semantic Versioning specification)
  - MAJOR : 하위 호환되지 않는 변경분
  - MINOR : 하위 호환되는 변경분
  - PATCH : 하위 호환 되는 오류 수정
- 하위 호환되는 소규모 변경
- 중대한 대규모 변경
#### 3.1.4 메시지 포맷
- 텍스트 메시지 포맷 : JSON, XML
- 이진 메시지 포맷 : 프로토콜 버퍼, 아브로
### 3.2 동기 RPI 패턴 응용 통신
#### 3.2.1 동기 RPI 패턴 : REST
- REST 성숙도 모델
  - 레벨 0